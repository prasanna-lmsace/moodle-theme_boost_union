{"version":3,"file":"smartmenu.min.js","sources":["../src/smartmenu.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Union - JS for smartmenu to make the third level submenu support.\n *\n * @module     theme_boost_union/smartmenu\n * @copyright  bdecent GmbH 2023\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\n/**\n * Implement the second level of submenu support.\n * Find the submenus inside the dropdown add event listener for click event, on the click show the submenu list.\n */\nconst addSubmenu = () => {\n    // Fetch the list of submenus from moremenu.\n    var submenu = document.querySelectorAll('nav.moremenu .dropdown-submenu');\n    if (submenu !== null) {\n        submenu.forEach((item) => {\n            // Add event listener to show the submenu on click.\n            item.addEventListener('click', (e) => {\n                e.preventDefault();\n                var target = e.currentTarget;\n                // Hide the shown menu.\n                hideSubmenus(target);\n                target.classList.toggle('show');\n                // Prevent the hide of parent menu.\n                e.stopPropagation();\n            });\n        });\n    }\n};\n\n/**\n * Hide visible submenus before display new submenu.\n *\n * @param {Selector} target\n */\nconst hideSubmenus = (target) => {\n    var visibleMenu = document.querySelectorAll('nav.moremenu .dropdown-submenu.show');\n    if (visibleMenu !== null) {\n        visibleMenu.forEach((el) => {\n            if (el != target) {\n                el.classList.remove('show');\n            }\n        });\n    }\n};\n\n/**\n * Make the no wrapped card menus scroll using swipe or drag.\n */\nconst cardScroll = () => {\n    var cards = document.querySelectorAll('.card-dropdown.card-overflow-no-wrap');\n    if (cards !== null) {\n        var scrollStart; // Verify the mouse is clicked and still in click not released.\n        var scrollMoved; // Prevent the click on scrolling.\n        let startPos, scrollPos;\n\n        cards.forEach((card) => {\n            var scrollElement = card.querySelector('.dropdown-menu');\n\n            scrollElement.addEventListener('mousedown', (e) => {\n                scrollStart = true;\n                var target = e.currentTarget.querySelector('.card-block-wrapper');\n                startPos = e.pageX;\n                scrollPos = target.scrollLeft;\n            });\n\n            scrollElement.addEventListener('mousemove', (e) => {\n                e.preventDefault();\n                if (!scrollStart) {\n                    return;\n                }\n                scrollMoved = true;\n                var target = e.currentTarget.querySelector('.card-block-wrapper');\n                const scroll = e.pageX - startPos;\n                target.scrollLeft = scrollPos - scroll;\n            });\n\n            scrollElement.addEventListener('click', (e) => {\n                if (scrollMoved) {\n                    e.preventDefault();\n                    scrollMoved = false;\n                }\n                e.stopPropagation();\n            });\n            scrollElement.addEventListener('mouseleave', () => {\n                scrollStart = false;\n                scrollMoved = false;\n            });\n            scrollElement.addEventListener('mouseup', () => {\n                scrollStart = false;\n            });\n       });\n    }\n};\n\nexport const init = () => {\n    addSubmenu();\n    cardScroll();\n};\n"],"names":["hideSubmenus","target","visibleMenu","document","querySelectorAll","forEach","el","classList","remove","submenu","item","addEventListener","e","preventDefault","currentTarget","toggle","stopPropagation","cards","scrollStart","scrollMoved","startPos","scrollPos","card","scrollElement","querySelector","pageX","scrollLeft","scroll","cardScroll"],"mappings":";;;;;;;;MAoDMA,aAAgBC,aACdC,YAAcC,SAASC,iBAAiB,uCACxB,OAAhBF,aACAA,YAAYG,SAASC,KACbA,IAAML,QACNK,GAAGC,UAAUC,OAAO,0BAuDhB,KApFD,IAEXC,QACY,QADZA,QAAUN,SAASC,iBAAiB,oCAEpCK,QAAQJ,SAASK,OAEbA,KAAKC,iBAAiB,SAAUC,IAC5BA,EAAEC,qBACEZ,OAASW,EAAEE,cAEfd,aAAaC,QACbA,OAAOM,UAAUQ,OAAO,QAExBH,EAAEI,wBAyBC,UACXC,MAAQd,SAASC,iBAAiB,2CACxB,OAAVa,MAAgB,KACZC,YACAC,gBACAC,SAAUC,UAEdJ,MAAMZ,SAASiB,WACPC,cAAgBD,KAAKE,cAAc,kBAEvCD,cAAcZ,iBAAiB,aAAcC,IACzCM,aAAc,MACVjB,OAASW,EAAEE,cAAcU,cAAc,uBAC3CJ,SAAWR,EAAEa,MACbJ,UAAYpB,OAAOyB,cAGvBH,cAAcZ,iBAAiB,aAAcC,OACzCA,EAAEC,kBACGK,mBAGLC,aAAc,MACVlB,OAASW,EAAEE,cAAcU,cAAc,6BACrCG,OAASf,EAAEa,MAAQL,SACzBnB,OAAOyB,WAAaL,UAAYM,UAGpCJ,cAAcZ,iBAAiB,SAAUC,IACjCO,cACAP,EAAEC,iBACFM,aAAc,GAElBP,EAAEI,qBAENO,cAAcZ,iBAAiB,cAAc,KACzCO,aAAc,EACdC,aAAc,KAElBI,cAAcZ,iBAAiB,WAAW,KACtCO,aAAc,UAQ1BU"}